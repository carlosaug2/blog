<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Maurício Antunes">
    <meta name="description" content="Maurício Antunes personal website">
    <meta name="keywords" content="blog,software,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to build a blog using Pelican - Part III"/>
<meta name="twitter:description" content="This is the last post of this series. In the last I talked about plugins and tools used to deploy this blog.
Today we are going to check what kind of magic trick I am using to get fresh and updated content after a simple git push. In resume it uses Travis CI and SSH authentication.
SSH keys I am not that kind of crazy-about-security-person but I try to do my best."/>

    <meta property="og:title" content="How to build a blog using Pelican - Part III" />
<meta property="og:description" content="This is the last post of this series. In the last I talked about plugins and tools used to deploy this blog.
Today we are going to check what kind of magic trick I am using to get fresh and updated content after a simple git push. In resume it uses Travis CI and SSH authentication.
SSH keys I am not that kind of crazy-about-security-person but I try to do my best." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.maugzoide.com/posts/how-to-build-a-blog-using-pelican-part-iii/" />
<meta property="article:published_time" content="2016-01-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-01-05T00:00:00+00:00" />


    
      <base href="https://www.maugzoide.com/posts/how-to-build-a-blog-using-pelican-part-iii/">
    
    <title>
  How to build a blog using Pelican - Part III · Maurício Antunes
</title>

    
      <link rel="canonical" href="https://www.maugzoide.com/posts/how-to-build-a-blog-using-pelican-part-iii/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://www.maugzoide.com/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="https://www.maugzoide.com/css/custom.css" />
    

    
    
    <link rel="icon" type="image/png" href="https://www.maugzoide.com/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://www.maugzoide.com/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.58.3" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://www.maugzoide.com/">
      Maurício Antunes
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.maugzoide.com/">Home</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.maugzoide.com/posts/">Posts</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.maugzoide.com/tags/">Tags</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.maugzoide.com/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">How to build a blog using Pelican - Part III</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2016-01-05T00:00:00Z'>
                January 5, 2016
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              3 minutes read
            </span>
          </div>
          
          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://www.maugzoide.com/tags/pelican/">pelican</a>
      <span class="separator">•</span>
    <a href="https://www.maugzoide.com/tags/python/">python</a>
      <span class="separator">•</span>
    <a href="https://www.maugzoide.com/tags/travis/">travis</a></div>

        </div>
      </header>

      <div>
        

<p>This is the last post of this series. In the last I
talked about plugins and tools used to deploy this blog.</p>

<p>Today we are going to check what kind of magic trick I am using to get
fresh and updated content after a simple git push. In resume it uses
<a href="https://travis-ci.org/">Travis CI</a> and SSH authentication.</p>

<h2 id="ssh-keys">SSH keys</h2>

<p>I am not that kind of crazy-about-security-person but I try to do my
best. At work I use SSH keys, two-factor authentication when possible
and other security mechanisms. In order to make it easier to write and
publish content, we don&rsquo;t want to ask for passwords when deploying our
new content to the server - it would not work easily for tablets or
smartphones, would it?</p>

<p>Now you need to generate a pair of SSH keys. Github has a <a href="https://help.github.com/articles/generating-ssh-keys/">good
tutorial</a> around
this topic.</p>

<p>After setting up a new SSH key we need to install <a href="https://docs.travis-ci.com/user/encryption-keys/">Travis
encryption</a> tool:</p>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sourceCode .shell" data-lang=".sourceCode .shell">$ gem install travis</code></pre></div>
<p>Right after generating the SSH keys you need to add it to your
<em>authorized_keys</em> file inside your server.</p>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sourceCode .shell" data-lang=".sourceCode .shell">$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</code></pre></div>
<p>We don&rsquo;t want to send our unencrypted file to Github, right? To achieve
a higher level of security we need to encrypt our file using that Travis
tool we just installed:</p>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sourceCode .shell" data-lang=".sourceCode .shell">$ travis encrypt-file deploy-key # (the private one, not the .pub)</code></pre></div>
<p>This command will generate a file with the .enc extension. Add the .enc
file to repository.</p>

<p><strong>Don&rsquo;t ever publish your rsa_file to the upstream. After being visible
to other you are by yourself.</strong></p>

<h2 id="travis-ci">Travis CI</h2>

<p>Travis CI is a continuous integration platform. It is an easy to use
online tool that provides a backend infrastructure to test and deploy
code.</p>

<p>First you need to setup a Travis account, authenticated with Github and
turn on your blog repository. Currently Travis is only integrated to
Github so if you are using Bitbucket you may want to use another
service.</p>

<p>To run Travis jobs your code needs to maintain a .travis.yml file. Here
is how my file looks like:</p>
<div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sourceCode .shell" data-lang=".sourceCode .shell">language: python
sudo: false
branches:
  only:
    - master
git:
  submodules: false
before_install:
    - git submodule update --init --recursive
    - echo -e &#34;Host 162.243.186.254\n\tStrictHostKeyChecking no\n&#34; &gt;&gt; ~/.ssh/config
    - openssl aes-256-cbc -K $encrypted_bd9d366e80a4_key -iv $encrypted_bd9d366e80a4_iv -in deploy-key.enc -out deploy-key -d
    - chmod 600 deploy-key
    - mv deploy-key ~/.ssh/id_rsa
install: &#34;pip install -r requirements.txt&#34;
script: 
    - pelican content
    - fab publish</code></pre></div>
<p>This file above describes the steps and resources used to run the Travis
jobs.</p>

<p>In plain english it build a Python job only when it is the master
branch.</p>

<p>before_install is an important directive that tells what is needed to
bootstrap the environment (project provision goes here). Also it adds my
Digital Ocean droplet IP to the known hosts, decrypts the deploy-key.enc
file (file generated running travis-encrypt command) and copy it to the
SSH keys in the Travis containers.</p>

<p>install is another important directive. Note that we are not creating a
virtualenv here. It is not so necessary here because Travis isolates
jobs using Docker containers so everything is dropped after finished.</p>

<p>script is the part where we tell which commands need to run in order to
achieve our goal: generate the static content and publish it using
Fabric.</p>

<h2 id="conclusion">Conclusion</h2>

<p>I hope you have learned something on this series. Leave a comment if you
have any questions on how to setup a blog using Pelican.</p>

<p>Peace! :-)</p>

      </div>

      <footer>
        


        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "maugzoide" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        
        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
      <p>Removing code makes me happy</p>
    
     © 2020
    
       · 
      Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
